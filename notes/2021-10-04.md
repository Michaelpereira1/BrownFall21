---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Building Datasets From multiple Sources

+++

1. jsdkfds
1. fdsf
1. kdskfjsld

```{code-cell} ipython3
import pandas as pd
```

```{code-cell} ipython3
course_data_url = 'https://raw.githubusercontent.com/rhodyprog4ds/rhodyds/main/data/'
```

```{code-cell} ipython3
p18 = pd.read_csv(course_data_url +'2018-players.csv')
p19 = pd.read_csv(course_data_url +'2019-players.csv')
```

```{code-cell} ipython3
p18.head()
```

```{code-cell} ipython3
players_df = pd.concat([p18,p19])
players_df.shape
```

```{code-cell} ipython3
p18.shape, p19.shape
```

```{code-cell} ipython3
748+626
```

```{code-cell} ipython3
pd.merge(p18,p19,on='PLAYER_ID').head()
```

```{code-cell} ipython3
year_over_year = pd.merge(p18,p19,on='PLAYER_ID',suffixes=('_2018','_2019'))
```

```{code-cell} ipython3
year_over_year.shape, p18.shape, p19.shape
```

```{code-cell} ipython3
 pd.merge(p18,p19,on='PLAYER_ID',suffixes=('_2018','_2019'),how='outer').shape
```

```{code-cell} ipython3
year_over_year_outer =  pd.merge(p18,p19,on='PLAYER_ID',suffixes=('_2018','_2019'),how='outer')
```

```{code-cell} ipython3
year_over_year_outer.head()
```

```{code-cell} ipython3
year_over_year_outer.sample(10)
```

```{code-cell} ipython3
left = pd.DataFrame(
  {
    "key1": ["K0", "K0", "K1", "K2"],
    "key2": ["K0", "K1", "K0", "K1"],
    "A": ["A0", "A1", "A2", "A3"],
    "B": ["B0", "B1", "B2", "B3"],
  }
)


right = pd.DataFrame(
  {
    "key1": ["K0", "K1", "K1", "K2"],
    "key2": ["K0", "K0", "K0", "K0"],
    "C": ["C0", "C1", "C2", "C3"],
    "D": ["D0", "D1", "D2", "D3"],
  }
)

```

```{code-cell} ipython3
left
```

```{code-cell} ipython3
right
```

```{code-cell} ipython3

result = pd.merge(left, right, on=["key1", "key2"])
result
```

```{code-cell} ipython3
pd.merge(left, right, on=["key1", "key2"], how='outer' )
```

```{code-cell} ipython3
left = pd.DataFrame({"A": [1, 2], "B": [2, 2]})

right = pd.DataFrame({"A": [4, 5, 6], "B": [2, 2, 2]})

result = pd.merge(left, right, on="B", how="outer")
```

```{code-cell} ipython3
left
```

```{code-cell} ipython3
right
```

```{code-cell} ipython3
result
```

```{code-cell} ipython3
pd.merge(left, right,on='B',validate='one_to_one')
```

```{code-cell} ipython3

```
