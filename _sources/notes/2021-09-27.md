---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

## Cleaning Data
This week, we'll be cleaning data.



Cleaning data is labor intensive and requires making subjective choices.  

We'll focus on, and assess you on, manipulating data correctly, making reasonable

choices, and documenting the choices you make carefully.



We'll focus on the programming tools that get used in cleaning data in class

this week:

reshaping data
handling missing or incorrect values

```{code-cell} ipython3
import pandas as pd
import seaborn as sns

sns.set_theme(font_scale=2)
arabica_data_url = 'https://raw.githubusercontent.com/jldbc/coffee-quality-database/master/data/arabica_data_cleaned.csv'
```

Read in the three csv files described below and store them in a list of dataFrames

```{code-cell} ipython3
url_base = 'https://raw.githubusercontent.com/rhodyprog4ds/rhodyds/main/data/'

datasets = ['study_a.csv','study_b.csv','study_c.csv']
```

```{code-cell} ipython3
df_list = [pd.read_csv(url_base + file,na_values= '') for file in datasets]
```

```{code-cell} ipython3
df_list[0]
```

```{code-cell} ipython3
df_list[1]
```

```{code-cell} ipython3
df_list[2]
```

```{code-cell} ipython3
treat_df = df_list[0]
```

```{code-cell} ipython3
treat_df.head()
```

```{code-cell} ipython3
treat_df.columns
```

```{code-cell} ipython3
treat_df.melt(value_vars = [' treatmenta',' treatmentb'],
             id_vars = ['name'],
             value_name = 'result', var_name = 'treatment' )
```

```{code-cell} ipython3
tidy_treat_df = treat_df.melt(value_vars = [' treatmenta',' treatmentb'],
             id_vars = ['name'],
             value_name = 'result', var_name = 'treatment' )
```

```{code-cell} ipython3
tidy_treat_df.
```

```{code-cell} ipython3
tidy_treat_df.groupby('name').mean()
```

```{code-cell} ipython3
coffee_df = pd.read_csv(arabica_data_url, index_col = 0)
coffee_df.head()
```

```{code-cell} ipython3
# compute ___ per ___
bag_total_df = coffee_df.groupby('Country.of.Origin')['Number.of.Bags'].sum()
```

```{code-cell} ipython3
high_prod_countries =  list(bag_total_df[bag_total_df>15000].index)
```

```{code-cell} ipython3
high_prod = lambda c: c in high_prod_countries
```

```{code-cell} ipython3
high_prod('Mexico')
```

```{code-cell} ipython3
high_prod('Ethiopa')
```

```{code-cell} ipython3
coffee_df['high_production'] = coffee_df['Country.of.Origin'].apply(high_prod)
```

```{code-cell} ipython3
coffee_df.head()
```

```{code-cell} ipython3
high_prod_coffee_df = coffee_df[coffee_df['high_production']]
```

```{code-cell} ipython3
low_prod_coffee_df = coffee_df[coffee_df['high_production']==False]
```

```{code-cell} ipython3

```
